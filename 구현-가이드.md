# VM ì˜¤í† ìŠ¤ì¼€ì¼ë§ êµ¬í˜„ ìƒì„¸ ê°€ì´ë“œ

**ì‘ì„±ì¼**: 2025-11-20  
**ë²„ì „**: 1.0

---

## ğŸ“‹ ëª©ì°¨

1. [í™˜ê²½ ì„¤ì •](#í™˜ê²½-ì„¤ì •)
2. [í…œí”Œë¦¿ ê´€ë¦¬ êµ¬í˜„](#í…œí”Œë¦¿-ê´€ë¦¬-êµ¬í˜„)
3. [ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì • êµ¬í˜„](#ì˜¤í† ìŠ¤ì¼€ì¼ë§-ì„¤ì •-êµ¬í˜„)
4. [PLG Stack ì—°ë™ êµ¬í˜„](#plg-stack-ì—°ë™-êµ¬í˜„)
5. [Jenkins íŒŒì´í”„ë¼ì¸ êµ¬í˜„](#jenkins-íŒŒì´í”„ë¼ì¸-êµ¬í˜„)
6. [F5 ìë™ ì—°ë™ êµ¬í˜„](#f5-ìë™-ì—°ë™-êµ¬í˜„)
7. [IP Pool ê´€ë¦¬ êµ¬í˜„](#ip-pool-ê´€ë¦¬-êµ¬í˜„)

---

## í™˜ê²½ ì„¤ì •

### 1. í•„ìˆ˜ ë„êµ¬ ì„¤ì¹˜

```bash
# govc ì„¤ì¹˜ (vCenter API ì‚¬ìš©)
brew install govc

# ë˜ëŠ” ì§ì ‘ ë‹¤ìš´ë¡œë“œ
wget https://github.com/vmware/govmomi/releases/download/v0.30.0/govc_darwin_amd64.gz
gunzip govc_darwin_amd64.gz
chmod +x govc_darwin_amd64
sudo mv govc_darwin_amd64 /usr/local/bin/govc
```

### 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

```bash
# vCenter ì—°ê²° ì •ë³´
export GOVC_URL=https://10.255.0.10
export GOVC_USERNAME=administrator@vsphere.local
export GOVC_PASSWORD=VMware1!

# Jenkins ì„œë²„ ì ‘ì† ì •ë³´
export JENKINS_SERVER=10.255.0.103
export JENKINS_SSH_USER=jenkins
export JENKINS_SSH_PASSWORD=!danacloud12
export JENKINS_WEB_USER=danacloud
export JENKINS_WEB_PASSWORD=!danacloud12

# Jenkins ì—°ê²° ì •ë³´
export JENKINS_URL=http://10.255.0.103:8080
export JENKINS_USER=jenkins
export JENKINS_TOKEN=<jenkins-api-token>

# F5 ì—°ê²° ì •ë³´
export F5_SERVERS=10.255.1.80,10.255.1.81
export F5_USERNAME=admin
export F5_PASSWORD=<f5-password>

# PLG Stack ì„œë²„ ì ‘ì† ì •ë³´
export PLG_STACK_SERVER=10.255.1.254
export PLG_STACK_USER=ubuntu
export PLG_STACK_SSH_KEY=/Users/jhlee/Desktop/Work/Dana-Cloud-Oper/DanaIX-ì‹ ê·œ\ VM\ ìƒì„±/00.\ SSH-PemKey-List/danainfra

# PLG Stack ì—°ê²° ì •ë³´ (ì‹¤ì œ ì„œë²„ ì •ë³´)
export PROMETHEUS_URL=http://10.255.1.254:9090
export ALERTMANAGER_URL=http://10.255.1.254:9093
export GRAFANA_URL=http://10.255.1.254:3000
export LOKI_URL=http://10.255.1.254:3100

# Jenkins Webhook ì •ë³´ (Alertmanagerì—ì„œ í˜¸ì¶œ)
export JENKINS_WEBHOOK_URL=http://10.255.0.103:8080/generic-webhook-trigger/invoke?token=plg-autoscale-token
export JENKINS_WEBHOOK_USER=danacloud
export JENKINS_WEBHOOK_PASSWORD=!danacloud12
```

### 3. PLG Stack ì„œë²„ ì •ë³´

#### ì„œë²„ ì ‘ì† ì •ë³´
- **ì„œë²„ IP**: `10.255.1.254`
- **ì‚¬ìš©ì**: `ubuntu`
- **SSH Key ê²½ë¡œ**: `/Users/jhlee/Desktop/Work/Dana-Cloud-Oper/DanaIX-ì‹ ê·œ VM ìƒì„±/00. SSH-PemKey-List/danainfra`

#### ì„œë²„ ì ‘ì† ë°©ë²•
```bash
# SSH ì ‘ì†
ssh -i '/Users/jhlee/Desktop/Work/Dana-Cloud-Oper/DanaIX-ì‹ ê·œ VM ìƒì„±/00. SSH-PemKey-List/danainfra' ubuntu@10.255.1.254
```

#### PLG Stack êµ¬ì„± ìš”ì†Œ

| êµ¬ì„± ìš”ì†Œ | í¬íŠ¸ | ì ‘ì† URL | ë¡œê·¸ì¸ ì •ë³´ | ì„¤ëª… |
|---------|------|----------|------------|------|
| **Prometheus** | 9090 | http://10.255.1.254:9090 | - | ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë° Alert Rule í‰ê°€ |
| **Alertmanager** | 9093 | http://10.255.1.254:9093 | - | ì•Œë¦¼ ê´€ë¦¬ ë° Webhook ì „ì†¡ |
| **Grafana** | 3000 | http://10.255.1.254:3000 | admin / admin123 | ëŒ€ì‹œë³´ë“œ ë° ì‹œê°í™” |
| **Loki** | 3100 | http://10.255.1.254:3100 | - | ë¡œê·¸ ìˆ˜ì§‘ (ì„ íƒì‚¬í•­) |

#### Docker ì»¨í…Œì´ë„ˆ ì •ë³´
```bash
# ì»¨í…Œì´ë„ˆ ëª©ë¡ í™•ì¸
sudo docker ps

# ì˜ˆìƒ ì¶œë ¥:
# NAMES          IMAGE                      PORTS
# grafana        grafana/grafana:latest     0.0.0.0:3000->3000/tcp
# prometheus     prom/prometheus:latest     0.0.0.0:9090->9090/tcp
# alertmanager   prom/alertmanager:latest    0.0.0.0:9093->9093/tcp
# loki           grafana/loki:latest        0.0.0.0:3100->3100/tcp
```

#### ì„¤ì • íŒŒì¼ ìœ„ì¹˜

| êµ¬ì„± ìš”ì†Œ | ì„¤ì • íŒŒì¼ ê²½ë¡œ (í˜¸ìŠ¤íŠ¸) | ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ê²½ë¡œ |
|---------|----------------------|------------------|
| **Prometheus** | `/mnt/plg-stack/prometheus/prometheus.yml` | `/etc/prometheus/prometheus.yml` |
| **Alert Rules** | `/mnt/plg-stack/prometheus/rules/alert_rules.yml` | `/etc/prometheus/rules/alert_rules.yml` |
| **Alertmanager** | `/mnt/plg-stack/alertmanager/config/alertmanager.yml` | `/etc/alertmanager/alertmanager.yml` |

#### ì„¤ì • íŒŒì¼ ìˆ˜ì • ë°©ë²•
```bash
# 1. ì„œë²„ ì ‘ì†
ssh -i '/Users/jhlee/Desktop/Work/Dana-Cloud-Oper/DanaIX-ì‹ ê·œ VM ìƒì„±/00. SSH-PemKey-List/danainfra' ubuntu@10.255.1.254

# 2. Prometheus ì„¤ì • ìˆ˜ì •
sudo vi /mnt/plg-stack/prometheus/prometheus.yml

# 3. Alert Rules ìˆ˜ì •
sudo vi /mnt/plg-stack/prometheus/rules/alert_rules.yml

# 4. Alertmanager ì„¤ì • ìˆ˜ì •
sudo vi /mnt/plg-stack/alertmanager/config/alertmanager.yml

# 5. ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘ (ì„¤ì • ì ìš©)
sudo docker restart prometheus
sudo docker restart alertmanager
```

#### í˜„ì¬ Prometheus ì„¤ì • ìš”ì•½
- **Scrape Interval**: 15ì´ˆ
- **Evaluation Interval**: 15ì´ˆ
- **ëª¨ë‹ˆí„°ë§ ëŒ€ìƒ**:
  - `prometheus` (ìì²´ ëª¨ë‹ˆí„°ë§)
  - `alertmanager` (Alertmanager ëª¨ë‹ˆí„°ë§)
  - `loki` (Loki ëª¨ë‹ˆí„°ë§)
  - `nginx-test-01` (10.255.1.253:9100)
  - `nginx-test-02` (10.255.1.102:9100)

#### í˜„ì¬ Alertmanager ì„¤ì • ìš”ì•½
- **Webhook URL**: `http://10.255.0.103:8080/generic-webhook-trigger/invoke?token=plg-autoscale-token`
- **Webhook ì¸ì¦**: Basic Auth (`danacloud` / `!danacloud12`)
- **ë¼ìš°íŒ… ê·œì¹™**: `severity: critical` ë˜ëŠ” `severity: warning` ì•Œë¦¼ì„ Jenkins Webhookìœ¼ë¡œ ì „ì†¡
- **Group Wait**: 10ì´ˆ
- **Repeat Interval**: 12ì‹œê°„

#### í˜„ì¬ Alert Rules ìš”ì•½
- **Alert Rules íŒŒì¼**: `/mnt/plg-stack/prometheus/rules/alert_rules.yml`
- **ê·¸ë£¹**:
  - `vm-autoscale`: VM ì˜¤í† ìŠ¤ì¼€ì¼ë§ ê´€ë ¨ ê·œì¹™ (í˜„ì¬ í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ë¹„í™œì„±í™”)
  - `nginx-test-autoscale`: nginx-test ì„œë²„ ëª¨ë‹ˆí„°ë§ ê·œì¹™ (í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ë¹„í™œì„±í™”)
- **ì£¼ìš” Alert**:
  - `HighCPU`: CPU ì‚¬ìš©ë¥  ì„ê³„ì¹˜ (í˜„ì¬ ë¹„í™œì„±í™”)
  - `HighMemory`: Memory ì‚¬ìš©ë¥  ì„ê³„ì¹˜ (í˜„ì¬ ë¹„í™œì„±í™”)
  - `HighDisk`: Disk ì‚¬ìš©ë¥  ì„ê³„ì¹˜ (í˜„ì¬ ë¹„í™œì„±í™”)

### 4. Jenkins ì„œë²„ ì •ë³´

#### ì„œë²„ ì ‘ì† ì •ë³´
- **ì„œë²„ IP**: `10.255.0.103`
- **SSH ì ‘ì†**:
  - ì‚¬ìš©ì: `jenkins`
  - ë¹„ë°€ë²ˆí˜¸: `!danacloud12`
  - Sudo ë¹„ë°€ë²ˆí˜¸: `!danacloud12`
- **Web ì ‘ì†**:
  - URL: `http://10.255.0.103:8080/`
  - ì‚¬ìš©ì: `danacloud`
  - ë¹„ë°€ë²ˆí˜¸: `!danacloud12`

#### ì„œë²„ ì ‘ì† ë°©ë²•
```bash
# SSH ì ‘ì†
ssh jenkins@10.255.0.103
# ë¹„ë°€ë²ˆí˜¸: !danacloud12

# ë˜ëŠ” sshpass ì‚¬ìš©
sshpass -p '!danacloud12' ssh jenkins@10.255.0.103
```

#### Jenkins ê¸°ë³¸ ì •ë³´
- **Jenkins ë²„ì „**: `2.528.1`
- **Jenkins Home**: `/var/lib/jenkins`
- **Jenkins Port**: `8080` (IPv6: `:::8080`)
- **Jenkins í”„ë¡œì„¸ìŠ¤**: Java í”„ë¡œì„¸ìŠ¤ë¡œ ì‹¤í–‰ ì¤‘
- **Jenkins ì‚¬ìš©ì**: `jenkins`
- **Jenkins ê·¸ë£¹**: `jenkins`

#### Jenkins Jobs ëª©ë¡
| Job ì´ë¦„ | ì„¤ëª… | íƒ€ì… |
|---------|------|------|
| **plg-autoscale-out** | Alertmanager Webhook â†’ vCenter API â†’ F5 Pool ìë™ ë“±ë¡ íŒŒì´í”„ë¼ì¸ | Pipeline |
| **vm-deployment-pipeline** | Terraformì„ ì‚¬ìš©í•œ VM ìë™ ë°°í¬ íŒŒì´í”„ë¼ì¸ | Pipeline |
| **golden-image-build** | Packerë¥¼ ì‚¬ìš©í•œ ê³¨ë“  ì´ë¯¸ì§€ ë¹Œë“œ íŒŒì´í”„ë¼ì¸ | Pipeline |

#### ì„¤ì¹˜ëœ ì£¼ìš” í”ŒëŸ¬ê·¸ì¸
- **generic-webhook-trigger** (v2.4.1): Generic Webhook Trigger í”ŒëŸ¬ê·¸ì¸
- **workflow-job**: Pipeline Job ì§€ì›
- **git**: Git ì—°ë™
- **git-client**: Git í´ë¼ì´ì–¸íŠ¸
- **github**: GitHub ì—°ë™
- **pipeline-build-step**: Pipeline ë¹Œë“œ ë‹¨ê³„

#### Jenkins ì„¤ì • íŒŒì¼ ìœ„ì¹˜
| ì„¤ì • í•­ëª© | íŒŒì¼ ê²½ë¡œ |
|---------|----------|
| **Jenkins ë©”ì¸ ì„¤ì •** | `/var/lib/jenkins/config.xml` |
| **Credentials** | `/var/lib/jenkins/credentials.xml` |
| **Secrets** | `/var/lib/jenkins/secrets/` |
| **Job ì„¤ì •** | `/var/lib/jenkins/jobs/{job-name}/config.xml` |
| **Workspace** | `/var/lib/jenkins/workspace/{job-name}/` |

#### Generic Webhook Trigger ì„¤ì •

**plg-autoscale-out Jobì˜ Webhook ì„¤ì •**:
- **Webhook URL**: `http://10.255.0.103:8080/generic-webhook-trigger/invoke?token=plg-autoscale-token`
- **Token**: `plg-autoscale-token`
- **íŒŒì‹± ë³€ìˆ˜**:
  - `alertname`: `$.alerts[0].labels.alertname`
  - `instance`: `$.alerts[0].labels.instance`
  - `severity`: `$.alerts[0].labels.severity`
  - `status`: `$.status`
  - `summary`: `$.alerts[0].annotations.summary`
  - `description`: `$.alerts[0].annotations.description`
- **í•„í„°**: `status == "firing"` (firing ìƒíƒœì˜ ì•Œë¦¼ë§Œ ì²˜ë¦¬)

#### Jenkins Job ì„¤ì • í™•ì¸ ë°©ë²•
```bash
# 1. ì„œë²„ ì ‘ì†
ssh jenkins@10.255.0.103
# ë¹„ë°€ë²ˆí˜¸: !danacloud12

# 2. Job ì„¤ì • íŒŒì¼ í™•ì¸
echo "!danacloud12" | sudo -S cat /var/lib/jenkins/jobs/plg-autoscale-out/config.xml

# 3. Job ë¹Œë“œ ë¡œê·¸ í™•ì¸
echo "!danacloud12" | sudo -S ls -la /var/lib/jenkins/jobs/plg-autoscale-out/builds/

# 4. ìµœì‹  ë¹Œë“œ ë¡œê·¸ í™•ì¸
echo "!danacloud12" | sudo -S find /var/lib/jenkins/jobs/plg-autoscale-out/builds -name "log" -type f | sort -r | head -1 | xargs -I {} echo "!danacloud12" | sudo -S tail -100 {}
```

#### Jenkins ì„œë¹„ìŠ¤ ê´€ë¦¬
```bash
# Jenkins ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
echo "!danacloud12" | sudo -S systemctl status jenkins

# Jenkins ì„œë¹„ìŠ¤ ì¬ì‹œì‘
echo "!danacloud12" | sudo -S systemctl restart jenkins

# Jenkins ì„œë¹„ìŠ¤ ì‹œì‘
echo "!danacloud12" | sudo -S systemctl start jenkins

# Jenkins ì„œë¹„ìŠ¤ ì¤‘ì§€
echo "!danacloud12" | sudo -S systemctl stop jenkins
```

#### Jenkins API ì‚¬ìš©
```bash
# Jenkins API í† í° ìƒì„± (Web UIì—ì„œ)
# Manage Jenkins â†’ Manage Users â†’ danacloud â†’ Configure â†’ API Token ìƒì„±

# API í˜¸ì¶œ ì˜ˆì‹œ
curl -u danacloud:!danacloud12 http://10.255.0.103:8080/api/json

# Job ì‹¤í–‰
curl -X POST -u danacloud:!danacloud12 \
  "http://10.255.0.103:8080/job/plg-autoscale-out/build?token=plg-autoscale-token"
```

### 5. ë°ì´í„° ì €ì¥ì†Œ ì„¤ì •

```bash
# ë°ì´í„° ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p /Users/jhlee/Desktop/Work/Dana-Cloud-Oper/DanaIX-Infra-Automation/VM-Autoscaling/data
```

---

## í…œí”Œë¦¿ ê´€ë¦¬ êµ¬í˜„

### 1. ë°±ì—”ë“œ ì„œë¹„ìŠ¤ êµ¬í˜„

#### íŒŒì¼: `backend/src/services/templateService.js`

```javascript
const { exec } = require('child_process');
const util = require('util');
const execPromise = util.promisify(exec);
const fs = require('fs').promises;
const path = require('path');

const TEMPLATES_DATA_PATH = path.join(__dirname, '../../data/templates.json');
const VCENTER_URL = process.env.GOVC_URL;
const VCENTER_USERNAME = process.env.GOVC_USERNAME;
const VCENTER_PASSWORD = process.env.GOVC_PASSWORD;

/**
 * VMì„ í…œí”Œë¦¿ìœ¼ë¡œ ë³€í™˜
 * @param {string} vmId - VM ID ë˜ëŠ” ì´ë¦„
 * @param {string} templateName - í…œí”Œë¦¿ ì´ë¦„
 * @returns {Promise<object>} ë³€í™˜ ê²°ê³¼
 */
async function convertVmToTemplate(vmId, templateName) {
  try {
    // govc ëª…ë ¹ì–´ë¡œ VMì„ í…œí”Œë¦¿ìœ¼ë¡œ ë³€í™˜
    const command = `govc vm.markastemplate -vm="${vmId}" "${templateName}"`;
    
    await execPromise(command, {
      env: {
        ...process.env,
        GOVC_URL: VCENTER_URL,
        GOVC_USERNAME: VCENTER_USERNAME,
        GOVC_PASSWORD: VCENTER_PASSWORD
      }
    });

    return {
      success: true,
      templateName: templateName,
      message: `VM '${vmId}'ì„ í…œí”Œë¦¿ '${templateName}'ìœ¼ë¡œ ë³€í™˜í–ˆìŠµë‹ˆë‹¤.`
    };
  } catch (error) {
    console.error(`[Template Service] í…œí”Œë¦¿ ë³€í™˜ ì‹¤íŒ¨:`, error);
    throw new Error(`í…œí”Œë¦¿ ë³€í™˜ ì‹¤íŒ¨: ${error.message}`);
  }
}

/**
 * í…œí”Œë¦¿ ë©”íƒ€ë°ì´í„° ì €ì¥
 * @param {object} templateData - í…œí”Œë¦¿ ë°ì´í„°
 * @returns {Promise<object>} ì €ì¥ëœ í…œí”Œë¦¿ ì •ë³´
 */
async function saveTemplateMetadata(templateData) {
  try {
    // ê¸°ì¡´ í…œí”Œë¦¿ ëª©ë¡ ë¡œë“œ
    let templates = [];
    try {
      const data = await fs.readFile(TEMPLATES_DATA_PATH, 'utf8');
      templates = JSON.parse(data);
    } catch (err) {
      // íŒŒì¼ì´ ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ë¡œ ì‹œì‘
      templates = [];
    }

    // ìƒˆ í…œí”Œë¦¿ ì¶”ê°€
    const newTemplate = {
      id: `template-${Date.now()}`,
      ...templateData,
      createdAt: new Date().toISOString()
    };
    templates.push(newTemplate);

    // íŒŒì¼ì— ì €ì¥
    await fs.writeFile(TEMPLATES_DATA_PATH, JSON.stringify(templates, null, 2));

    return newTemplate;
  } catch (error) {
    console.error(`[Template Service] í…œí”Œë¦¿ ë©”íƒ€ë°ì´í„° ì €ì¥ ì‹¤íŒ¨:`, error);
    throw new Error(`í…œí”Œë¦¿ ë©”íƒ€ë°ì´í„° ì €ì¥ ì‹¤íŒ¨: ${error.message}`);
  }
}

/**
 * í…œí”Œë¦¿ ëª©ë¡ ì¡°íšŒ
 * @returns {Promise<Array>} í…œí”Œë¦¿ ëª©ë¡
 */
async function getTemplates() {
  try {
    const data = await fs.readFile(TEMPLATES_DATA_PATH, 'utf8');
    return JSON.parse(data);
  } catch (error) {
    if (error.code === 'ENOENT') {
      return [];
    }
    throw error;
  }
}

/**
 * í…œí”Œë¦¿ ìƒì„¸ ì¡°íšŒ
 * @param {string} templateId - í…œí”Œë¦¿ ID
 * @returns {Promise<object>} í…œí”Œë¦¿ ì •ë³´
 */
async function getTemplateById(templateId) {
  const templates = await getTemplates();
  return templates.find(t => t.id === templateId);
}

/**
 * í…œí”Œë¦¿ ì‚­ì œ
 * @param {string} templateId - í…œí”Œë¦¿ ID
 * @returns {Promise<object>} ì‚­ì œ ê²°ê³¼
 */
async function deleteTemplate(templateId) {
  try {
    const templates = await getTemplates();
    const template = templates.find(t => t.id === templateId);
    
    if (!template) {
      throw new Error(`í…œí”Œë¦¿ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${templateId}`);
    }

    // vCenterì—ì„œ í…œí”Œë¦¿ ì‚­ì œ (ì„ íƒì‚¬í•­)
    // await execPromise(`govc object.destroy "${template.vcenterTemplateName}"`);

    // ë©”íƒ€ë°ì´í„°ì—ì„œ ì œê±°
    const updatedTemplates = templates.filter(t => t.id !== templateId);
    await fs.writeFile(TEMPLATES_DATA_PATH, JSON.stringify(updatedTemplates, null, 2));

    return {
      success: true,
      message: `í…œí”Œë¦¿ '${template.name}'ì„ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.`
    };
  } catch (error) {
    console.error(`[Template Service] í…œí”Œë¦¿ ì‚­ì œ ì‹¤íŒ¨:`, error);
    throw error;
  }
}

module.exports = {
  convertVmToTemplate,
  saveTemplateMetadata,
  getTemplates,
  getTemplateById,
  deleteTemplate
};
```

### 2. API ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„

#### íŒŒì¼: `backend/src/server.js` (ì¶”ê°€)

```javascript
const templateService = require('./services/templateService');

// í…œí”Œë¦¿ ìƒì„±
if (parsedUrl.pathname === '/api/templates' && req.method === 'POST') {
  let body = '';
  req.on('data', chunk => { body += chunk.toString(); });
  req.on('end', async () => {
    try {
      const payload = JSON.parse(body);
      
      // VMì„ í…œí”Œë¦¿ìœ¼ë¡œ ë³€í™˜
      const convertResult = await templateService.convertVmToTemplate(
        payload.sourceVmId,
        payload.name
      );

      // í…œí”Œë¦¿ ë©”íƒ€ë°ì´í„° ì €ì¥
      const template = await templateService.saveTemplateMetadata({
        name: payload.name,
        description: payload.description,
        vcenterTemplateName: payload.name,
        sourceVmId: payload.sourceVmId,
        sourceVmName: payload.sourceVmName
      });

      sendJSONResponse(res, 200, {
        success: true,
        template: template
      });
    } catch (error) {
      sendJSONResponse(res, 500, {
        success: false,
        error: error.message
      });
    }
  });
  return;
}

// í…œí”Œë¦¿ ëª©ë¡ ì¡°íšŒ
if (parsedUrl.pathname === '/api/templates' && req.method === 'GET') {
  try {
    const templates = await templateService.getTemplates();
    sendJSONResponse(res, 200, {
      success: true,
      templates: templates
    });
  } catch (error) {
    sendJSONResponse(res, 500, {
      success: false,
      error: error.message
    });
  }
  return;
}
```

---

## ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì • êµ¬í˜„

### 1. ë°±ì—”ë“œ ì„œë¹„ìŠ¤ êµ¬í˜„

#### íŒŒì¼: `backend/src/services/autoscalingService.js`

```javascript
const fs = require('fs').promises;
const path = require('path');

const CONFIGS_DATA_PATH = path.join(__dirname, '../../data/autoscaling-configs.json');

/**
 * ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì • ì €ì¥
 * @param {object} configData - ì„¤ì • ë°ì´í„°
 * @returns {Promise<object>} ì €ì¥ëœ ì„¤ì • ì •ë³´
 */
async function saveConfig(configData) {
  try {
    let configs = [];
    try {
      const data = await fs.readFile(CONFIGS_DATA_PATH, 'utf8');
      configs = JSON.parse(data);
    } catch (err) {
      configs = [];
    }

    const newConfig = {
      id: `autoscale-${Date.now()}`,
      ...configData,
      enabled: configData.enabled !== undefined ? configData.enabled : true,
      createdAt: new Date().toISOString(),
      updatedAt: new Date().toISOString()
    };
    configs.push(newConfig);

    await fs.writeFile(CONFIGS_DATA_PATH, JSON.stringify(configs, null, 2));
    return newConfig;
  } catch (error) {
    console.error(`[Autoscaling Service] ì„¤ì • ì €ì¥ ì‹¤íŒ¨:`, error);
    throw error;
  }
}

/**
 * ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì • ëª©ë¡ ì¡°íšŒ
 * @returns {Promise<Array>} ì„¤ì • ëª©ë¡
 */
async function getConfigs() {
  try {
    const data = await fs.readFile(CONFIGS_DATA_PATH, 'utf8');
    return JSON.parse(data);
  } catch (error) {
    if (error.code === 'ENOENT') {
      return [];
    }
    throw error;
  }
}

/**
 * ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì • ìƒì„¸ ì¡°íšŒ
 * @param {string} configId - ì„¤ì • ID
 * @returns {Promise<object>} ì„¤ì • ì •ë³´
 */
async function getConfigById(configId) {
  const configs = await getConfigs();
  return configs.find(c => c.id === configId);
}

/**
 * ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì • ìˆ˜ì •
 * @param {string} configId - ì„¤ì • ID
 * @param {object} updateData - ìˆ˜ì •í•  ë°ì´í„°
 * @returns {Promise<object>} ìˆ˜ì •ëœ ì„¤ì • ì •ë³´
 */
async function updateConfig(configId, updateData) {
  try {
    const configs = await getConfigs();
    const index = configs.findIndex(c => c.id === configId);
    
    if (index === -1) {
      throw new Error(`ì„¤ì •ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${configId}`);
    }

    configs[index] = {
      ...configs[index],
      ...updateData,
      updatedAt: new Date().toISOString()
    };

    await fs.writeFile(CONFIGS_DATA_PATH, JSON.stringify(configs, null, 2));
    return configs[index];
  } catch (error) {
    console.error(`[Autoscaling Service] ì„¤ì • ìˆ˜ì • ì‹¤íŒ¨:`, error);
    throw error;
  }
}

/**
 * ì˜¤í† ìŠ¤ì¼€ì¼ë§ í™œì„±í™”/ë¹„í™œì„±í™”
 * @param {string} configId - ì„¤ì • ID
 * @param {boolean} enabled - í™œì„±í™” ì—¬ë¶€
 * @returns {Promise<object>} ìˆ˜ì •ëœ ì„¤ì • ì •ë³´
 */
async function setConfigEnabled(configId, enabled) {
  return await updateConfig(configId, { enabled });
}

module.exports = {
  saveConfig,
  getConfigs,
  getConfigById,
  updateConfig,
  setConfigEnabled
};
```

---

## PLG Stack ì—°ë™ êµ¬í˜„

### 1. PLG Stack ì„œë²„ ì ‘ì† ë° ì„¤ì • íŒŒì¼ ìˆ˜ì •

#### ì„œë²„ ì ‘ì†
```bash
# PLG Stack ì„œë²„ ì ‘ì†
ssh -i '/Users/jhlee/Desktop/Work/Dana-Cloud-Oper/DanaIX-ì‹ ê·œ VM ìƒì„±/00. SSH-PemKey-List/danainfra' ubuntu@10.255.1.254
```

#### ì„¤ì • íŒŒì¼ ìœ„ì¹˜
- **Prometheus ì„¤ì •**: `/mnt/plg-stack/prometheus/prometheus.yml`
- **Alert Rules**: `/mnt/plg-stack/prometheus/rules/alert_rules.yml`
- **Alertmanager ì„¤ì •**: `/mnt/plg-stack/alertmanager/config/alertmanager.yml`

#### ì„¤ì • íŒŒì¼ ìˆ˜ì • í›„ ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
```bash
# Prometheus ì¬ì‹œì‘
sudo docker restart prometheus

# Alertmanager ì¬ì‹œì‘
sudo docker restart alertmanager
```

### 2. Prometheus Alert Rule ìƒì„±

#### íŒŒì¼: `backend/src/services/prometheusService.js`

```javascript
const axios = require('axios');
const { exec } = require('child_process');
const util = require('util');
const execPromise = util.promisify(exec);
const fs = require('fs').promises;

const PROMETHEUS_URL = process.env.PROMETHEUS_URL || 'http://10.255.1.254:9090';
const PLG_STACK_SERVER = process.env.PLG_STACK_SERVER || '10.255.1.254';
const PLG_STACK_USER = process.env.PLG_STACK_USER || 'ubuntu';
const PLG_STACK_SSH_KEY = process.env.PLG_STACK_SSH_KEY || '/Users/jhlee/Desktop/Work/Dana-Cloud-Oper/DanaIX-ì‹ ê·œ VM ìƒì„±/00. SSH-PemKey-List/danainfra';
const ALERT_RULES_PATH = '/mnt/plg-stack/prometheus/rules/alert_rules.yml';

/**
 * Prometheus Alert Rule ìƒì„±
 * @param {object} config - ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì •
 * @returns {Promise<object>} ìƒì„± ê²°ê³¼
 */
async function createAlertRule(config) {
  const alertRule = {
    alert: `${config.serviceName}_HighResourceUsage`,
    expr: `
      (
        avg(rate(node_cpu_seconds_total{job="${config.monitoring.prometheusJob}"}[5m])) * 100 > ${config.monitoring.cpuThreshold}
        OR
        avg(node_memory_MemTotal_bytes{job="${config.monitoring.prometheusJob}"} - node_memory_MemAvailable_bytes{job="${config.monitoring.prometheusJob}"}) / node_memory_MemTotal_bytes{job="${config.monitoring.prometheusJob}"} * 100 > ${config.monitoring.memoryThreshold}
      )
      AND
      (
        avg_over_time(rate(node_cpu_seconds_total{job="${config.monitoring.prometheusJob}"}[5m])[${config.monitoring.duration}m:]) * 100 > ${config.monitoring.cpuThreshold}
        OR
        avg_over_time((node_memory_MemTotal_bytes{job="${config.monitoring.prometheusJob}"} - node_memory_MemAvailable_bytes{job="${config.monitoring.prometheusJob}"}) / node_memory_MemTotal_bytes{job="${config.monitoring.prometheusJob}"}[${config.monitoring.duration}m:]) * 100 > ${config.monitoring.memoryThreshold}
      )
    `,
    for: `${config.monitoring.duration}m`,
    labels: {
      severity: 'warning',
      service: config.serviceName,
      autoscaleConfigId: config.id
    },
    annotations: {
      summary: `${config.serviceName} ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ë¥ ì´ ë†’ìŠµë‹ˆë‹¤`,
      description: `CPU ë˜ëŠ” Memory ì‚¬ìš©ë¥ ì´ ${config.monitoring.cpuThreshold}%ë¥¼ ì´ˆê³¼í•˜ì—¬ ${config.monitoring.duration}ë¶„ ì´ìƒ ì§€ì†ë˜ì—ˆìŠµë‹ˆë‹¤.`
    }
  };

  // PLG Stack ì„œë²„ì˜ Alert Rules íŒŒì¼ì— ì¶”ê°€
  try {
    // SSHë¡œ ì„œë²„ì— ì ‘ì†í•˜ì—¬ Alert Rules íŒŒì¼ ìˆ˜ì •
    const sshCommand = `ssh -i "${PLG_STACK_SSH_KEY}" -o StrictHostKeyChecking=no ${PLG_STACK_USER}@${PLG_STACK_SERVER} "cat ${ALERT_RULES_PATH}"`;
    const currentRules = await execPromise(sshCommand);
    
    // YAML íŒŒì‹± ë° ìƒˆ ê·œì¹™ ì¶”ê°€ (ì‹¤ì œ êµ¬í˜„ ì‹œ yaml ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©)
    // ì—¬ê¸°ì„œëŠ” ê°„ë‹¨í•œ ì˜ˆì‹œë§Œ ì œê³µ
    
    // ìƒˆ ê·œì¹™ì„ íŒŒì¼ì— ì¶”ê°€í•˜ëŠ” ëª…ë ¹ì–´
    const addRuleCommand = `ssh -i "${PLG_STACK_SSH_KEY}" -o StrictHostKeyChecking=no ${PLG_STACK_USER}@${PLG_STACK_SERVER} << 'EOF'
cat >> ${ALERT_RULES_PATH} << 'ALERTRULE'
  - alert: ${alertRule.alert}
    expr: ${alertRule.expr}
    for: ${alertRule.for}
    labels:
      severity: ${alertRule.labels.severity}
      service: ${alertRule.labels.service}
      autoscaleConfigId: ${alertRule.labels.autoscaleConfigId}
    annotations:
      summary: ${alertRule.annotations.summary}
      description: ${alertRule.annotations.description}
ALERTRULE
sudo docker restart prometheus
EOF
`;
    
    await execPromise(addRuleCommand);
    
    return {
      success: true,
      alertRule: alertRule,
      message: 'Alert Ruleì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.'
    };
  } catch (error) {
    console.error(`[Prometheus Service] Alert Rule ì¶”ê°€ ì‹¤íŒ¨:`, error);
    throw new Error(`Alert Rule ì¶”ê°€ ì‹¤íŒ¨: ${error.message}`);
  }
}

/**
 * Prometheus ì„¤ì •ì— ìƒˆ Job ì¶”ê°€
 * @param {object} config - ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì •
 * @returns {Promise<object>} ì„¤ì • ê²°ê³¼
 */
async function addPrometheusJob(config) {
  const prometheusConfigPath = '/mnt/plg-stack/prometheus/prometheus.yml';
  const sshCommand = `ssh -i "${PLG_STACK_SSH_KEY}" -o StrictHostKeyChecking=no ${PLG_STACK_USER}@${PLG_STACK_SERVER}`;
  
  // Prometheus ì„¤ì • íŒŒì¼ì— ìƒˆ scrape_config ì¶”ê°€
  // ì‹¤ì œ êµ¬í˜„ ì‹œ YAML íŒŒì‹± ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
  
  const newJobConfig = `
  # ${config.serviceName} ëª¨ë‹ˆí„°ë§
  - job_name: '${config.monitoring.prometheusJob}'
    static_configs:
      - targets: ['${config.monitoring.targets.join("', '")}']
        labels:
          instance: '${config.serviceName}'
          service: '${config.serviceName}'
          environment: 'production'
`;
  
  // ì„¤ì • íŒŒì¼ì— ì¶”ê°€ (ì‹¤ì œ êµ¬í˜„ í•„ìš”)
  // ...
  
  // Prometheus ì¬ì‹œì‘
  await execPromise(`${sshCommand} "sudo docker restart prometheus"`);
  
  return {
    success: true,
    message: 'Prometheus Jobì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.'
  };
}

module.exports = {
  createAlertRule,
  addPrometheusJob
};
```

### 3. Prometheus ì„¤ì • í™•ì¸

#### í˜„ì¬ Prometheus ì„¤ì • ìš”ì•½
- **ì„¤ì • íŒŒì¼**: `/mnt/plg-stack/prometheus/prometheus.yml`
- **Scrape Interval**: 15ì´ˆ
- **Evaluation Interval**: 15ì´ˆ
- **í˜„ì¬ ëª¨ë‹ˆí„°ë§ ëŒ€ìƒ**:
  - `prometheus` (ìì²´ ëª¨ë‹ˆí„°ë§)
  - `alertmanager` (Alertmanager ëª¨ë‹ˆí„°ë§)
  - `loki` (Loki ëª¨ë‹ˆí„°ë§)
  - `nginx-test-01` (10.255.1.253:9100)
  - `nginx-test-02` (10.255.1.102:9100)

#### ìƒˆ ì„œë¹„ìŠ¤ ëª¨ë‹ˆí„°ë§ ì¶”ê°€ ë°©ë²•
```bash
# 1. ì„œë²„ ì ‘ì†
ssh -i '/Users/jhlee/Desktop/Work/Dana-Cloud-Oper/DanaIX-ì‹ ê·œ VM ìƒì„±/00. SSH-PemKey-List/danainfra' ubuntu@10.255.1.254

# 2. Prometheus ì„¤ì • íŒŒì¼ ìˆ˜ì •
sudo vi /mnt/plg-stack/prometheus/prometheus.yml

# 3. ìƒˆ Job ì¶”ê°€ ì˜ˆì‹œ
# scrape_configs:
#   - job_name: 'web-server-service'
#     static_configs:
#       - targets: ['10.255.1.200:9100', '10.255.1.201:9100']
#         labels:
#           instance: 'web-server-service'
#           service: 'web-server'
#           environment: 'production'

# 4. Prometheus ì¬ì‹œì‘
sudo docker restart prometheus
```

### 4. Alertmanager Webhook ì„¤ì •

#### í˜„ì¬ Alertmanager ì„¤ì • (ì‹¤ì œ ì„œë²„)

**ì„¤ì • íŒŒì¼ ìœ„ì¹˜**: `/mnt/plg-stack/alertmanager/config/alertmanager.yml`

**í˜„ì¬ ì„¤ì • ë‚´ìš©**:
```yaml
global:
  resolve_timeout: 5m

route:
  group_by: ['alertname', 'cluster', 'service']
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 12h
  receiver: 'jenkins-webhook'
  routes:
    - match:
        severity: critical
      receiver: 'jenkins-webhook'
      continue: true
    - match:
        severity: warning
      receiver: 'jenkins-webhook'

receivers:
  - name: 'jenkins-webhook'
    webhook_configs:
      - url: 'http://10.255.0.103:8080/generic-webhook-trigger/invoke?token=plg-autoscale-token'
        send_resolved: true
        http_config:
          follow_redirects: true
          basic_auth:
            username: 'danacloud'
            password: '!danacloud12'
```

#### Alertmanager ì„¤ì • ìˆ˜ì • ë°©ë²•

```bash
# 1. ì„œë²„ ì ‘ì†
ssh -i '/Users/jhlee/Desktop/Work/Dana-Cloud-Oper/DanaIX-ì‹ ê·œ VM ìƒì„±/00. SSH-PemKey-List/danainfra' ubuntu@10.255.1.254

# 2. ì„¤ì • íŒŒì¼ ìˆ˜ì •
sudo vi /mnt/plg-stack/alertmanager/config/alertmanager.yml

# 3. Alertmanager ì¬ì‹œì‘
sudo docker restart alertmanager
```

#### Jenkins Webhook ì •ë³´
- **Webhook URL**: `http://10.255.0.103:8080/generic-webhook-trigger/invoke?token=plg-autoscale-token`
- **ì¸ì¦ ë°©ì‹**: Basic Auth
  - **Username**: `danacloud`
  - **Password**: `!danacloud12`
- **Token**: `plg-autoscale-token`

#### Alertmanager ì„¤ì • ìë™í™” (ë°±ì—”ë“œ ì„œë¹„ìŠ¤)

```javascript
/**
 * Alertmanager ì„¤ì •ì— ìƒˆ ë¼ìš°íŒ… ê·œì¹™ ì¶”ê°€
 * @param {object} config - ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì •
 * @returns {Promise<object>} ì„¤ì • ê²°ê³¼
 */
async function updateAlertmanagerConfig(config) {
  const sshCommand = `ssh -i "${PLG_STACK_SSH_KEY}" -o StrictHostKeyChecking=no ${PLG_STACK_USER}@${PLG_STACK_SERVER}`;
  const alertmanagerConfigPath = '/mnt/plg-stack/alertmanager/config/alertmanager.yml';
  
  // YAML íŒŒì¼ ì½ê¸°, ìˆ˜ì •, ì“°ê¸° (ì‹¤ì œ êµ¬í˜„ ì‹œ yaml ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©)
  // ì—¬ê¸°ì„œëŠ” ê°œë…ë§Œ ì œê³µ
  
  // ì„¤ì • íŒŒì¼ ë°±ì—…
  await execPromise(`${sshCommand} "sudo cp ${alertmanagerConfigPath} ${alertmanagerConfigPath}.backup"`);
  
  // ì„¤ì • íŒŒì¼ ìˆ˜ì • (YAML íŒŒì‹± ë° ë¼ìš°íŒ… ê·œì¹™ ì¶”ê°€)
  // ...
  
  // Alertmanager ì¬ì‹œì‘
  await execPromise(`${sshCommand} "sudo docker restart alertmanager"`);
  
  return {
    success: true,
    message: 'Alertmanager ì„¤ì •ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.'
  };
}
```

---

## Jenkins íŒŒì´í”„ë¼ì¸ êµ¬í˜„

### 1. Jenkins ì„œë²„ ì •ë³´

#### ë©€í‹° ì„œë¹„ìŠ¤ íŒŒì´í”„ë¼ì¸ ì•„í‚¤í…ì²˜

**ì¤‘ìš”**: ê° ì„œë¹„ìŠ¤(ê³ ê°)ë§ˆë‹¤ ë…ë¦½ì ì¸ Jenkins íŒŒì´í”„ë¼ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.

**ì´ìœ **:
- IaaS ì„œë¹„ìŠ¤ ìš´ì˜ í™˜ê²½ì—ì„œ 10~20ê°œì˜ ê³ ê°ì´ ê°ê° ë…ë¦½ì ì¸ ì„œë¹„ìŠ¤ë¥¼ ìš´ì˜
- ê° ì„œë¹„ìŠ¤ì˜ ìŠ¤ì¼€ì¼ì•„ì›ƒì´ ì„œë¡œ ì˜í–¥ì„ ì£¼ì§€ ì•Šì•„ì•¼ í•¨
- ì„œë¹„ìŠ¤ë³„ë¡œ ë‹¤ë¥¸ ìŠ¤ì¼€ì¼ë§ ì •ì±… ë° ì„¤ì •ì´ í•„ìš”
- ë…ë¦½ì ì¸ ë¡œê·¸ ê´€ë¦¬ ë° ëª¨ë‹ˆí„°ë§ í•„ìš”

**Job ëª…ëª… ê·œì¹™**:
- í˜•ì‹: `autoscale-{service-name}` ë˜ëŠ” `autoscale-{customer-name}-{service-name}`
- ì˜ˆì‹œ:
  - `autoscale-web-server-service`
  - `autoscale-customer-a-web-server`
  - `autoscale-customer-b-api-server`

#### í˜„ì¬ êµ¬ì„±ëœ Jenkins Jobs

**plg-autoscale-out** (ê¸°ì¡´ í†µí•© íŒŒì´í”„ë¼ì¸ - ì°¸ê³ ìš©):
- **ì„¤ëª…**: Alertmanager Webhook â†’ Jenkins â†’ vCenter API â†’ F5 Pool ìë™ ë“±ë¡ íŒŒì´í”„ë¼ì¸
- **Webhook Token**: `plg-autoscale-token`
- **Webhook URL**: `http://10.255.0.103:8080/generic-webhook-trigger/invoke?token=plg-autoscale-token`
- **ì„¤ì • íŒŒì¼**: `/var/lib/jenkins/jobs/plg-autoscale-out/config.xml`
- **ì°¸ê³ **: ì´ Jobì€ ì˜ˆì‹œìš©ì´ë©°, ì‹¤ì œë¡œëŠ” ê° ì„œë¹„ìŠ¤ë§ˆë‹¤ ë…ë¦½ì ì¸ Jobì„ ìƒì„±í•´ì•¼ í•¨

**vm-deployment-pipeline** (VM ë°°í¬ íŒŒì´í”„ë¼ì¸):
- **ì„¤ëª…**: Terraformì„ ì‚¬ìš©í•œ VM ìë™ ë°°í¬ íŒŒì´í”„ë¼ì¸
- **Git ì €ì¥ì†Œ**: `https://github.com/zzambab98/vm-deployment-pipeline.git`
- **Jenkinsfile ê²½ë¡œ**: `jenkins/Jenkinsfile`
- **íŒŒë¼ë¯¸í„°**: `VM_ENVIRONMENT` (í™˜ê²½ ì´ë¦„)

#### ì„œë¹„ìŠ¤ë³„ ë…ë¦½ íŒŒì´í”„ë¼ì¸ ì˜ˆì‹œ

**autoscale-web-server-service** (ì„œë¹„ìŠ¤ 1):
- **Webhook Token**: `autoscale-web-server-service-token`
- **Webhook URL**: `http://10.255.0.103:8080/generic-webhook-trigger/invoke?token=autoscale-web-server-service-token`
- **ì„¤ì • íŒŒì¼**: `/var/lib/jenkins/jobs/autoscale-web-server-service/config.xml`

**autoscale-api-server-service** (ì„œë¹„ìŠ¤ 2):
- **Webhook Token**: `autoscale-api-server-service-token`
- **Webhook URL**: `http://10.255.0.103:8080/generic-webhook-trigger/invoke?token=autoscale-api-server-service-token`
- **ì„¤ì • íŒŒì¼**: `/var/lib/jenkins/jobs/autoscale-api-server-service/config.xml`

#### Jenkins Job ì„¤ì • í™•ì¸ ë° ìˆ˜ì •

```bash
# 1. ì„œë²„ ì ‘ì†
ssh jenkins@10.255.0.103
# ë¹„ë°€ë²ˆí˜¸: !danacloud12

# 2. Job ì„¤ì • íŒŒì¼ í™•ì¸
sudo cat /var/lib/jenkins/jobs/plg-autoscale-out/config.xml

# 3. Job ì„¤ì • íŒŒì¼ ìˆ˜ì • (ì£¼ì˜: ì§ì ‘ ìˆ˜ì • ì‹œ Jenkins ì¬ì‹œì‘ í•„ìš”)
sudo vi /var/lib/jenkins/jobs/plg-autoscale-out/config.xml
sudo systemctl restart jenkins

# 4. Job ë¹Œë“œ ë¡œê·¸ í™•ì¸
sudo tail -f /var/lib/jenkins/jobs/plg-autoscale-out/builds/{build-number}/log
```

### 2. Jenkinsfile ì‘ì„±

#### íŒŒì¼: `jenkins/Jenkinsfile.autoscale` (ìƒˆë¡œìš´ ìë™ ìŠ¤ì¼€ì¼ì•„ì›ƒ íŒŒì´í”„ë¼ì¸)

```groovy
pipeline {
    agent any
    
    parameters {
        string(name: 'AUTOSCALE_CONFIG_ID', defaultValue: '', description: 'ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì • ID')
        string(name: 'TEMPLATE_NAME', defaultValue: '', description: 'í…œí”Œë¦¿ ì´ë¦„')
        string(name: 'F5_POOL_NAME', defaultValue: '', description: 'F5 Pool ì´ë¦„')
        string(name: 'VIP', defaultValue: '', description: 'VIP ì£¼ì†Œ')
        string(name: 'VIP_PORT', defaultValue: '80', description: 'VIP í¬íŠ¸')
        string(name: 'IP_POOL_START', defaultValue: '', description: 'IP Pool ì‹œì‘ ì£¼ì†Œ')
        string(name: 'IP_POOL_END', defaultValue: '', description: 'IP Pool ì¢…ë£Œ ì£¼ì†Œ')
        string(name: 'VLAN', defaultValue: '', description: 'VLAN ì´ë¦„')
    }
    
    stages {
        stage('Checkout') {
            steps {
                echo 'Checking out code...'
                // í•„ìš”ì‹œ ì½”ë“œ ì²´í¬ì•„ì›ƒ
            }
        }
        
        stage('Get Available IP') {
            steps {
                script {
                    def ipRange = "${params.IP_POOL_START}-${params.IP_POOL_END}"
                    def availableIp = sh(
                        script: """
                            python3 scripts/get-available-ip.py \
                                --start ${params.IP_POOL_START} \
                                --end ${params.IP_POOL_END} \
                                --subnet ${params.VLAN}
                        """,
                        returnStdout: true
                    ).trim()
                    
                    env.VM_IP = availableIp
                    echo "í• ë‹¹ëœ IP: ${env.VM_IP}"
                }
            }
        }
        
        stage('Ping Test') {
            steps {
                script {
                    def pingResult = sh(
                        script: """
                            ping -c 3 -W 2 ${env.VM_IP} || exit 1
                        """,
                        returnStatus: true
                    )
                    
                    if (pingResult == 0) {
                        error("IP ${env.VM_IP}ê°€ ì´ë¯¸ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤. ë‹¤ë¥¸ IPë¥¼ ì„ íƒí•˜ì„¸ìš”.")
                    }
                    
                    echo "IP ${env.VM_IP} ì‚¬ìš© ê°€ëŠ¥ í™•ì¸"
                }
            }
        }
        
        stage('Create VM from Template') {
            steps {
                script {
                    def vmName = "vm-${params.AUTOSCALE_CONFIG_ID}-${BUILD_NUMBER}"
                    
                    sh """
                        govc vm.clone \
                            -vm="${params.TEMPLATE_NAME}" \
                            -ds=datastore1 \
                            -folder=/DC/vm \
                            -net="${params.VLAN}" \
                            -ip="${env.VM_IP}" \
                            -netmask="255.255.255.0" \
                            -gateway="10.255.1.1" \
                            "${vmName}"
                    """
                    
                    env.VM_NAME = vmName
                    echo "VM ìƒì„± ì™„ë£Œ: ${env.VM_NAME}"
                }
            }
        }
        
        stage('Wait for VM Boot') {
            steps {
                script {
                    echo "VM ë¶€íŒ… ëŒ€ê¸° ì¤‘..."
                    sleep(time: 60, unit: 'SECONDS')
                    
                    // VMì´ ë¶€íŒ…ë  ë•Œê¹Œì§€ ëŒ€ê¸°
                    def maxRetries = 30
                    def retryCount = 0
                    def vmReady = false
                    
                    while (retryCount < maxRetries && !vmReady) {
                        def pingResult = sh(
                            script: "ping -c 1 -W 2 ${env.VM_IP}",
                            returnStatus: true
                        )
                        
                        if (pingResult == 0) {
                            vmReady = true
                            echo "VM ë¶€íŒ… ì™„ë£Œ: ${env.VM_IP}"
                        } else {
                            retryCount++
                            sleep(time: 10, unit: 'SECONDS')
                        }
                    }
                    
                    if (!vmReady) {
                        error("VM ë¶€íŒ… ì‹¤íŒ¨: ${env.VM_IP}")
                    }
                }
            }
        }
        
        stage('Health Check') {
            steps {
                script {
                    echo "Health Check ìˆ˜í–‰ ì¤‘..."
                    // ì‹¤ì œ Health Check ë¡œì§ êµ¬í˜„
                    // ì˜ˆ: HTTP ìš”ì²­, ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸ ë“±
                }
            }
        }
        
        stage('Add to F5 Pool') {
            steps {
                script {
                    sh """
                        python3 scripts/add-f5-pool-member.py \
                            --pool ${params.F5_POOL_NAME} \
                            --member ${env.VM_IP}:${params.VIP_PORT} \
                            --vip ${params.VIP}
                    """
                    echo "F5 Poolì— Member ì¶”ê°€ ì™„ë£Œ: ${env.VM_IP}:${params.VIP_PORT}"
                }
            }
        }
    }
    
    post {
        success {
            echo 'ìŠ¤ì¼€ì¼ì•„ì›ƒ ì„±ê³µ!'
            // ì„±ê³µ ì•Œë¦¼ (Slack, Email ë“±)
        }
        failure {
            echo 'ìŠ¤ì¼€ì¼ì•„ì›ƒ ì‹¤íŒ¨!'
            // ì‹¤íŒ¨ ì•Œë¦¼ ë° ë¡¤ë°±
        }
    }
}
```

### 3. ì„œë¹„ìŠ¤ë³„ Jenkins Job ìë™ ìƒì„±

#### ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì • ì‹œ ìë™ Job ìƒì„±

ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì •ì„ ìƒì„±í•  ë•Œë§ˆë‹¤ í•´ë‹¹ ì„œë¹„ìŠ¤ì— ëŒ€í•œ ë…ë¦½ì ì¸ Jenkins Jobì´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.

#### ë°±ì—”ë“œ ì„œë¹„ìŠ¤ êµ¬í˜„ (Jenkins Job ìë™ ìƒì„±)

```javascript
// backend/src/services/jenkinsService.js

const axios = require('axios');
const { exec } = require('child_process');
const util = require('util');
const execPromise = util.promisify(exec);

const JENKINS_URL = process.env.JENKINS_URL || 'http://10.255.0.103:8080';
const JENKINS_USER = process.env.JENKINS_WEB_USER || 'danacloud';
const JENKINS_PASSWORD = process.env.JENKINS_WEB_PASSWORD || '!danacloud12';
const JENKINS_SERVER = process.env.JENKINS_SERVER || '10.255.0.103';
const JENKINS_SSH_USER = process.env.JENKINS_SSH_USER || 'jenkins';
const JENKINS_SSH_PASSWORD = process.env.JENKINS_SSH_PASSWORD || '!danacloud12';

/**
 * ì„œë¹„ìŠ¤ë³„ Jenkins Job ìƒì„±
 * @param {object} config - ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì •
 * @returns {Promise<object>} ìƒì„± ê²°ê³¼
 */
async function createJenkinsJob(config) {
  const jobName = config.jenkins.jobName || `autoscale-${config.serviceName.toLowerCase().replace(/\s+/g, '-')}`;
  const webhookToken = config.jenkins.webhookToken || `${jobName}-token`;
  
  // Jenkins Job XML ìƒì„±
  const jobXml = generateJobXml(jobName, webhookToken, config);
  
  // Jenkins APIë¥¼ í†µí•´ Job ìƒì„±
  const createJobUrl = `${JENKINS_URL}/createItem?name=${encodeURIComponent(jobName)}`;
  const auth = Buffer.from(`${JENKINS_USER}:${JENKINS_PASSWORD}`).toString('base64');
  
  try {
    const response = await axios.post(createJobUrl, jobXml, {
      headers: {
        'Content-Type': 'application/xml',
        'Authorization': `Basic ${auth}`
      }
    });
    
    return {
      success: true,
      jobName: jobName,
      webhookToken: webhookToken,
      webhookUrl: `${JENKINS_URL}/generic-webhook-trigger/invoke?token=${webhookToken}`
    };
  } catch (error) {
    console.error(`[Jenkins Service] Job ìƒì„± ì‹¤íŒ¨:`, error);
    throw new Error(`Jenkins Job ìƒì„± ì‹¤íŒ¨: ${error.message}`);
  }
}

/**
 * Jenkins Job XML ìƒì„±
 */
function generateJobXml(jobName, webhookToken, config) {
  return `<?xml version='1.1' encoding='UTF-8'?>
<flow-definition plugin="workflow-job@2.45">
  <description>ìë™ ìŠ¤ì¼€ì¼ì•„ì›ƒ íŒŒì´í”„ë¼ì¸ - ${config.serviceName}</description>
  <keepDependencies>false</keepDependencies>
  <properties>
    <org.jenkinsci.plugins.workflow.job.properties.PipelineTriggersJobProperty>
      <triggers>
        <org.jenkinsci.plugins.gwt.GenericTrigger plugin="generic-webhook-trigger@2.4.1">
          <spec></spec>
          <genericVariables>
            <org.jenkinsci.plugins.gwt.GenericVariable>
              <key>alertname</key>
              <value>\$.alerts[0].labels.alertname</value>
              <regexpFilter></regexpFilter>
            </org.jenkinsci.plugins.gwt.GenericVariable>
            <org.jenkinsci.plugins.gwt.GenericVariable>
              <key>instance</key>
              <value>\$.alerts[0].labels.instance</value>
              <regexpFilter></regexpFilter>
            </org.jenkinsci.plugins.gwt.GenericVariable>
            <org.jenkinsci.plugins.gwt.GenericVariable>
              <key>service</key>
              <value>\$.alerts[0].labels.service</value>
              <regexpFilter></regexpFilter>
            </org.jenkinsci.plugins.gwt.GenericVariable>
            <org.jenkinsci.plugins.gwt.GenericVariable>
              <key>autoscaleConfigId</key>
              <value>\$.alerts[0].labels.autoscaleConfigId</value>
              <regexpFilter></regexpFilter>
            </org.jenkinsci.plugins.gwt.GenericVariable>
            <org.jenkinsci.plugins.gwt.GenericVariable>
              <key>status</key>
              <value>\$.status</value>
              <regexpFilter></regexpFilter>
            </org.jenkinsci.plugins.gwt.GenericVariable>
          </genericVariables>
          <regexpFilterText>\$status</regexpFilterText>
          <regexpFilterExpression>^firing\$</regexpFilterExpression>
          <printPostContent>true</printPostContent>
          <printContributedVariables>true</printContributedVariables>
          <causeString>Alert: \$alertname - Service: \$service</causeString>
          <token>${webhookToken}</token>
          <silentResponse>false</silentResponse>
        </org.jenkinsci.plugins.gwt.GenericTrigger>
      </triggers>
    </org.jenkinsci.plugins.workflow.job.properties.PipelineTriggersJobProperty>
  </properties>
  <definition class="org.jenkinsci.plugins.workflow.cps.CpsScmFlowDefinition" plugin="workflow-cps@2.92">
    <scm class="hudson.plugins.git.GitSCM" plugin="git@4.11.4">
      <configVersion>2</configVersion>
      <userRemoteConfigs>
        <hudson.plugins.git.UserRemoteConfig>
          <url>https://github.com/zzambab98/vm-deployment-pipeline.git</url>
        </hudson.plugins.git.UserRemoteConfig>
      </userRemoteConfigs>
      <branches>
        <hudson.plugins.git.BranchSpec>
          <name>*/main</name>
        </hudson.plugins.git.BranchSpec>
      </branches>
      <doGenerateSubmoduleConfigurations>false</doGenerateSubmoduleConfigurations>
      <submoduleCfg class="list"/>
      <extensions/>
    </scm>
    <scriptPath>jenkins/Jenkinsfile.autoscale</scriptPath>
    <lightweight>true</lightweight>
  </definition>
  <disabled>false</disabled>
</flow-definition>`;
}

module.exports = {
  createJenkinsJob
};
```

#### Web UIë¥¼ í†µí•œ ìˆ˜ë™ Job ìƒì„± (ì°¸ê³ ìš©)

1. Jenkins Web UI ì ‘ì†: `http://10.255.0.103:8080/`
2. ë¡œê·¸ì¸: `danacloud` / `!danacloud12`
3. "New Item" í´ë¦­
4. Job ì´ë¦„ ì…ë ¥ (ì˜ˆ: `autoscale-web-server-service`)
5. "Pipeline" ì„ íƒ
6. "OK" í´ë¦­
7. Pipeline ì„¤ì •:
   - **Definition**: Pipeline script from SCM
   - **SCM**: Git
   - **Repository URL**: `https://github.com/zzambab98/vm-deployment-pipeline.git`
   - **Script Path**: `jenkins/Jenkinsfile.autoscale`
8. Generic Webhook Trigger ì„¤ì •:
   - "Build Triggers" ì„¹ì…˜ì—ì„œ "Generic Webhook Trigger" ì²´í¬
   - **Token**: ì„œë¹„ìŠ¤ë³„ ê³ ìœ  í† í° ì…ë ¥ (ì˜ˆ: `autoscale-web-server-service-token`)
   - **Post content parameters** ì¶”ê°€
9. "Save" í´ë¦­

#### Alertmanagerì—ì„œ ì„œë¹„ìŠ¤ë³„ ë¼ìš°íŒ… ì„¤ì •

ê° ì„œë¹„ìŠ¤ë³„ë¡œ ë‹¤ë¥¸ Jenkins Jobìœ¼ë¡œ ë¼ìš°íŒ…í•˜ë„ë¡ Alertmanager ì„¤ì •:

```yaml
# /mnt/plg-stack/alertmanager/config/alertmanager.yml

route:
  group_by: ['alertname', 'cluster', 'service']
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 12h
  receiver: 'default-webhook'
  routes:
    # ì„œë¹„ìŠ¤ë³„ ë¼ìš°íŒ… ê·œì¹™
    - match:
        service: web-server-service
      receiver: 'jenkins-webhook-web-server'
      continue: false
    - match:
        service: api-server-service
      receiver: 'jenkins-webhook-api-server'
      continue: false
    # ê¸°ë³¸ ë¼ìš°íŒ… (ê¸°ì¡´ ì„œë¹„ìŠ¤)
    - match:
        severity: critical
      receiver: 'default-webhook'
      continue: true
    - match:
        severity: warning
      receiver: 'default-webhook'

receivers:
  # ì„œë¹„ìŠ¤ë³„ Webhook ìˆ˜ì‹ ì
  - name: 'jenkins-webhook-web-server'
    webhook_configs:
      - url: 'http://10.255.0.103:8080/generic-webhook-trigger/invoke?token=autoscale-web-server-service-token'
        send_resolved: true
        http_config:
          follow_redirects: true
          basic_auth:
            username: 'danacloud'
            password: '!danacloud12'
  
  - name: 'jenkins-webhook-api-server'
    webhook_configs:
      - url: 'http://10.255.0.103:8080/generic-webhook-trigger/invoke?token=autoscale-api-server-service-token'
        send_resolved: true
        http_config:
          follow_redirects: true
          basic_auth:
            username: 'danacloud'
            password: '!danacloud12'
  
  # ê¸°ë³¸ Webhook (ê¸°ì¡´ ì„œë¹„ìŠ¤ìš©)
  - name: 'default-webhook'
    webhook_configs:
      - url: 'http://10.255.0.103:8080/generic-webhook-trigger/invoke?token=plg-autoscale-token'
        send_resolved: true
        http_config:
          follow_redirects: true
          basic_auth:
            username: 'danacloud'
            password: '!danacloud12'
```

#### Jenkins APIë¥¼ í†µí•œ Job ì‹¤í–‰ (í…ŒìŠ¤íŠ¸ìš©)
```bash
# ì„œë¹„ìŠ¤ë³„ Webhookì„ í†µí•œ ìë™ ì‹¤í–‰ (Alertmanagerì—ì„œ í˜¸ì¶œ)
# Web Server Service
curl -X POST \
  "http://10.255.0.103:8080/generic-webhook-trigger/invoke?token=autoscale-web-server-service-token" \
  -H "Content-Type: application/json" \
  -d '{
    "status": "firing",
    "alerts": [{
      "labels": {
        "alertname": "HighCPU",
        "instance": "10.255.1.100:9100",
        "service": "web-server-service",
        "autoscaleConfigId": "autoscale-001",
        "severity": "critical"
      },
      "annotations": {
        "summary": "CPU usage is above 80%",
        "description": "CPU usage is 85% for 5 minutes"
      }
    }]
  }'

# API Server Service
curl -X POST \
  "http://10.255.0.103:8080/generic-webhook-trigger/invoke?token=autoscale-api-server-service-token" \
  -H "Content-Type: application/json" \
  -d '{
    "status": "firing",
    "alerts": [{
      "labels": {
        "alertname": "HighCPU",
        "instance": "10.255.1.200:9100",
        "service": "api-server-service",
        "autoscaleConfigId": "autoscale-002",
        "severity": "critical"
      },
      "annotations": {
        "summary": "CPU usage is above 80%",
        "description": "CPU usage is 85% for 5 minutes"
      }
    }]
  }'

# ìˆ˜ë™ ì‹¤í–‰ (íŒŒë¼ë¯¸í„° í¬í•¨)
curl -X POST \
  -u danacloud:!danacloud12 \
  "http://10.255.0.103:8080/job/vm-autoscale-out/buildWithParameters?token=plg-autoscale-token" \
  --data-urlencode "AUTOSCALE_CONFIG_ID=autoscale-001" \
  --data-urlencode "TEMPLATE_NAME=Web-Server-Template" \
  --data-urlencode "F5_POOL_NAME=web-server-pool" \
  --data-urlencode "VIP=10.255.1.100" \
  --data-urlencode "VIP_PORT=80" \
  --data-urlencode "IP_POOL_START=10.255.1.200" \
  --data-urlencode "IP_POOL_END=10.255.1.250" \
  --data-urlencode "VLAN=Vlan-101"
```

### 4. Jenkins Credential ì„¤ì •

#### Credential íŒŒì¼ ìœ„ì¹˜
- **Credentials ì„¤ì •**: `/var/lib/jenkins/credentials.xml`
- **Secrets ë””ë ‰í† ë¦¬**: `/var/lib/jenkins/secrets/`

#### ì£¼ìš” Credential (ì˜ˆìƒ)
- **vCenter ì¸ì¦ ì •ë³´**: `vcenter-server`, `vcenter-user`, `vcenter-password`
- **F5 ì¸ì¦ ì •ë³´**: `f5-credentials`
- **GitHub ì¸ì¦ ì •ë³´**: `github-credentials` ë˜ëŠ” `github-token`
- **SSH í‚¤**: `vm-ssh-key`, `vm-ssh-public-key`

#### Credential í™•ì¸ ë°©ë²•
```bash
# Credential íŒŒì¼ í™•ì¸ (ì•”í˜¸í™”ë˜ì–´ ìˆìŒ)
sudo cat /var/lib/jenkins/credentials.xml

# Web UIì—ì„œ í™•ì¸ ê¶Œì¥
# Manage Jenkins â†’ Manage Credentials â†’ System â†’ Global credentials
```

---

## F5 ìë™ ì—°ë™ êµ¬í˜„

### 1. F5 Pool Member ì¶”ê°€ ìŠ¤í¬ë¦½íŠ¸

#### íŒŒì¼: `scripts/add-f5-pool-member.py`

```python
#!/usr/bin/env python3
import requests
import json
import sys
import argparse
import os

F5_SERVERS = os.getenv('F5_SERVERS', '10.255.1.80').split(',')
F5_USERNAME = os.getenv('F5_USERNAME', 'admin')
F5_PASSWORD = os.getenv('F5_PASSWORD', '')
F5_PARTITION = 'Common'

def authenticate(server):
    """F5 ì¸ì¦ ë° í† í° íšë“"""
    url = f'https://{server}/mgmt/shared/authn/login'
    payload = {
        'username': F5_USERNAME,
        'password': F5_PASSWORD,
        'loginProviderName': 'tmos'
    }
    
    response = requests.post(url, json=payload, verify=False)
    response.raise_for_status()
    
    return response.json()['token']['token']

def add_pool_member(server, token, pool_name, member):
    """F5 Poolì— Member ì¶”ê°€"""
    url = f'https://{server}/mgmt/tm/ltm/pool/~{F5_PARTITION}~{pool_name}/members'
    headers = {
        'X-F5-Auth-Token': token,
        'Content-Type': 'application/json'
    }
    
    # Member í˜•ì‹: "IP:Port"
    member_data = {
        'name': member,
        'partition': F5_PARTITION
    }
    
    response = requests.post(url, headers=headers, json=member_data, verify=False)
    
    if response.status_code == 200 or response.status_code == 201:
        print(f'[F5] Pool Member ì¶”ê°€ ì„±ê³µ: {member}')
        return True
    elif response.status_code == 409:
        print(f'[F5] Pool Memberê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤: {member}')
        return True
    else:
        print(f'[F5] Pool Member ì¶”ê°€ ì‹¤íŒ¨: {response.status_code} - {response.text}')
        return False

def main():
    parser = argparse.ArgumentParser(description='F5 Poolì— Member ì¶”ê°€')
    parser.add_argument('--pool', required=True, help='Pool ì´ë¦„')
    parser.add_argument('--member', required=True, help='Member (IP:Port í˜•ì‹)')
    parser.add_argument('--vip', required=True, help='VIP ì£¼ì†Œ')
    
    args = parser.parse_args()
    
    # Primary F5 ì„œë²„ë§Œ ì‚¬ìš©
    primary_server = F5_SERVERS[0]
    
    try:
        # ì¸ì¦
        token = authenticate(primary_server)
        
        # Pool Member ì¶”ê°€
        success = add_pool_member(primary_server, token, args.pool, args.member)
        
        if success:
            print(f'[Success] F5 Pool Member ì¶”ê°€ ì™„ë£Œ: {args.member}')
            sys.exit(0)
        else:
            print(f'[Error] F5 Pool Member ì¶”ê°€ ì‹¤íŒ¨: {args.member}')
            sys.exit(1)
            
    except Exception as e:
        print(f'[Error] F5 ì—°ë™ ì‹¤íŒ¨: {str(e)}')
        sys.exit(1)

if __name__ == '__main__':
    main()
```

---

## IP Pool ê´€ë¦¬ êµ¬í˜„

### 1. ì‚¬ìš© ê°€ëŠ¥í•œ IP ì¡°íšŒ ìŠ¤í¬ë¦½íŠ¸

#### íŒŒì¼: `scripts/get-available-ip.py`

```python
#!/usr/bin/env python3
import ipaddress
import subprocess
import argparse
import sys

def ping_test(ip):
    """IP Ping í…ŒìŠ¤íŠ¸"""
    try:
        result = subprocess.run(
            ['ping', '-c', '1', '-W', '2', str(ip)],
            capture_output=True,
            timeout=5
        )
        return result.returncode == 0
    except:
        return False

def get_available_ip(start_ip, end_ip, subnet=None):
    """ì‚¬ìš© ê°€ëŠ¥í•œ IP ì°¾ê¸°"""
    start = ipaddress.IPv4Address(start_ip)
    end = ipaddress.IPv4Address(end_ip)
    
    # IP ë²”ìœ„ ë‚´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ IP ì°¾ê¸°
    for ip in ipaddress.summarize_address_range(start, end):
        for addr in ip:
            if addr == start or addr == end:
                continue
            
            # Ping í…ŒìŠ¤íŠ¸
            if not ping_test(addr):
                return str(addr)
    
    return None

def main():
    parser = argparse.ArgumentParser(description='ì‚¬ìš© ê°€ëŠ¥í•œ IP ì¡°íšŒ')
    parser.add_argument('--start', required=True, help='ì‹œì‘ IP')
    parser.add_argument('--end', required=True, help='ì¢…ë£Œ IP')
    parser.add_argument('--subnet', help='ì„œë¸Œë„· (ì„ íƒ)')
    
    args = parser.parse_args()
    
    available_ip = get_available_ip(args.start, args.end, args.subnet)
    
    if available_ip:
        print(available_ip)
        sys.exit(0)
    else:
        print('[Error] ì‚¬ìš© ê°€ëŠ¥í•œ IPë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', file=sys.stderr)
        sys.exit(1)

if __name__ == '__main__':
    main()
```

---

## ë‹¤ìŒ ë‹¨ê³„

1. **ë°±ì—”ë“œ API êµ¬í˜„ ì™„ë£Œ**
2. **í”„ë¡ íŠ¸ì—”ë“œ UI êµ¬í˜„**
3. **Jenkins íŒŒì´í”„ë¼ì¸ í…ŒìŠ¤íŠ¸**
4. **PLG Stack ì—°ë™ í…ŒìŠ¤íŠ¸**
5. **ì „ì²´ ì›Œí¬í”Œë¡œìš° í†µí•© í…ŒìŠ¤íŠ¸**

---

**ì‘ì„±ì**: Dana Cloud Automation Team  
**ìµœì¢… ìˆ˜ì •ì¼**: 2025-11-20

